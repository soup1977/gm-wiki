{% extends "wiki/base_wiki.html" %}
{% block title %}Compendium â€” {{ campaign.name }}{% endblock %}

{% block content %}
<h2 class="mb-4"><i class="bi bi-book"></i> Compendium</h2>

{% if categories %}
<div class="row g-4">

    <!-- Sidebar: category nav -->
    <div class="col-md-3">
        <div class="list-group">
            <a href="{{ url_for('wiki.wiki_compendium', campaign_id=campaign.id) }}"
               class="list-group-item list-group-item-action bg-dark border-secondary d-flex justify-content-between align-items-center
                      {% if not active_category %}active{% else %}text-light{% endif %}">
                All
                <span class="badge bg-secondary rounded-pill">{{ cat_counts.values() | sum }}</span>
            </a>
            {% for cat in categories %}
            <a href="{{ url_for('wiki.wiki_compendium', campaign_id=campaign.id, category=cat) }}"
               class="list-group-item list-group-item-action bg-dark border-secondary d-flex justify-content-between align-items-center
                      {% if active_category == cat %}active{% else %}text-light{% endif %}">
                {{ cat }}
                <span class="badge bg-secondary rounded-pill">{{ cat_counts[cat] }}</span>
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Main content: entries list -->
    <div class="col-md-9">
        {% if entries %}
        <div class="list-group">
            {% for entry in entries %}
            <a href="{{ url_for('wiki.wiki_compendium_detail', campaign_id=campaign.id, entry_id=entry.id) }}"
               class="list-group-item list-group-item-action bg-dark border-secondary d-flex justify-content-between align-items-center">
                {{ entry.title }}
                {% if not active_category and entry.category %}
                <span class="badge bg-secondary">{{ entry.category }}</span>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-muted">No entries in this category.</p>
        {% endif %}
    </div>

</div>
{% else %}
<p class="text-muted">No compendium entries available.</p>
{% endif %}
{% endblock %}
